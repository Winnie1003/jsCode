<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>1.时间扩展版</title>
	<style type="text/css">
		ul li, ul { margin: 0; padding: 0; list-style: none; }
		h2 { font-size: 30px; margin-left: 850px;}
		#list { width: 984px; height: 172px; margin: 100px auto; position: relative; border: 1px solid #000; overflow: hidden;}
		#list li { width: 122px; height: 344px; position: absolute; left: 0; top: 0;}

	</style>
	<script src="../miaov.js"></script>
	<script type="text/javascript">
		window.onload = function () {
			var oUl = $('list');
			var arrLi = oUl.getElementsByTagName('li');
			// var oP = document.getElementById('time');
			var arrMao = ['../img/colon.JPG','../img/colon1.JPG'];
			var num = 0;
			var showLi = [];
			var timer = null;

			//为每一个li设置left值
			for (var i = 0; i < arrLi.length; i++) {
				arrLi[i].style.left = i * 123 +"px";
			}

			//获取当前时间
			getDate()
			function getDate(){
				var myTime = new Date();
				var iHours = myTime.getHours();
				var iMin = myTime.getMinutes();
				var iSec = myTime.getSeconds();
				var str = '';
				str = toTwo(iHours)+toTwo(iMin)+toTwo(iSec);
				return str;
			}

			// 冒号自动闪烁
			function changeMao(){
				arrLi[2].getElementsByTagName('img')[0].src = arrMao[num%arrMao.length];
				arrLi[5].getElementsByTagName('img')[0].src = arrMao[num%arrMao.length];
				num++;
			}
			// setInterval(changeMao, 1000);
			
			// 初始化页面
			initTime();
			function initTime(){
				var str = getDate(); //只获取一次的时间，也就是旧的时间
				// oP.innerHTML = str;
				//获取所有的li,push到一个新的数组中。这个数组的作用是：得到除了冒号所有的li
				for (var i = 0; i < arrLi.length; i++) {
					showLi.push(arrLi[i]);
				}
				
				//在这个数组中 删除两个冒号；
				showLi.splice(2, 1);
				showLi.splice(4, 1);

				// //页面上显示当前时间
				for (var i = 0; i < showLi.length; i++) {
					var arrImg = showLi[i].getElementsByTagName('img');
					arrImg[0].src = '../img/'+ str.charAt(i) +'.JPG';
					showLi[i].index = parseInt(str.charAt(i)); //添加自定义属性
				}

				showLi.reverse(); //反转数组 让其从秒开始
			
				//时间上下移动
				for (var i = 0; i < showLi.length; i++) {
				 	moveTime(showLi[i],i);
				 } 
			};

			/*
				移动li的位置，让时间动起来。 此处移动的原理为：
				以秒举例：最后一个li的top先移动到 -172px 也就是ul的外面去。
				同时在回调函数中又把这个li拉回来，也就是到0px。
				让最后一个显示秒的li的，第1张和第2张图片始终显示为当前时间。这样就可以实现上下效果
			*/
			function moveTime(li,index){
				timer = setInterval(function(){
					var string = getDate(); //动态时间
					var len = string.length - 1; 
					var strChar = parseInt(string.charAt(len - index));
					var aImg = li.getElementsByTagName('img');
					aImg[1].src = '../img/' + strChar +'.JPG'; //初始化第二列img图片显示为当前时间

					/*
						li.index 为initTime 方法中添加的自定义属性。
						string.charAt(len - index) 为动态时间，因为定时器每隔一秒执行一次，所有每次获取到的时间是动态的
						此处可以理解为 旧的时间 和 动态时间 中的下标 进行对比，也就是 str和 string的下标对比
							比如：initTime中的 str 为：16：38：45
							      string 为： 16：38：46
							      li.index 为 5 strChar 为 6
							      两个值不等！
						如果不相等就执行下面的代码
					*/
					if (li.index != strChar) {
						doMove(li, 'top', 20, -172, function(){
							li.style.top = '0px';
							li.index = strChar;
							aImg[0].src = '../img/'+ strChar +'.JPG';
						});
					}
				}, 1000);
			}
		};

		//将小于10的时间前面加0
		function toTwo(n){
			return n < 10 ?  '0' + n : '' + n;
		}
	</script>
</head>
<body>
	<h2>小时、分钟、秒</h2>
<!-- 	<p id="time" style="font-size:60px;"></p> -->
	<ul id="list">
		<li>
			<img src="../img/0.JPG" alt="">
			<img src="../img/0.JPG" alt="">
		</li>
		<li>
			<img src="../img/0.JPG" alt="">
			<img src="../img/0.JPG" alt="">
		</li>
		<li>
			<img src="../img/colon.JPG" alt="">
		</li>
		<li>
			<img src="../img/0.JPG" alt="">
			<img src="../img/0.JPG" alt="">
		</li>
		<li>
			<img src="../img/0.JPG" alt="">
			<img src="../img/0.JPG" alt="">
		</li>
		<li>
			<img src="../img/colon.JPG" alt="">
		</li>
		<li>
			<img src="../img/0.JPG" alt="">
			<img src="../img/0.JPG" alt="">
		</li>
		<li>
			<img src="../img/0.JPG" alt="">
			<img src="../img/0.JPG" alt="">
		</li>>
	</ul>
</body>
</html>






























